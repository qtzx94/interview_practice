<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>错误监控</title>
    <script>
        // window.addEventListener('error', function(e) {
        //     console.log('捕获', e);
        // }, true);
        window.onerror = function() {
            console.log(arguments);
        }
    </script>
</head>
<body>
    <!--1.前端错误分类：
            即时运行错误：代码错误
            资源加载错误
        2.错误的捕获方式：
            即时运行类错误捕获方式：
                1.try...catch
                    try {
                        var a = 1;
                        var b = a + c;
                    } catch (e) {
                        // 捕获处理
                        console.log(e); // ReferenceError: c is not defined
                    }
                    使用try catch能够很好的捕获异常并对应进行相应处理，不至于让页面挂掉，但是其存在一些弊端，比如需要在捕获异常的代码上进行包裹，会导致页面臃肿不堪，不适用于整个项目的异常捕获。
                2.window.onerror: 提供了全局监听异常的功能
                    window.onerror = function(errorMessage, scriptURI, lineNo, columnNo, error) {
                        console.log('errorMessage: ' + errorMessage); // 异常信息
                        console.log('scriptURI: ' + scriptURI); // 异常文件路径
                        console.log('lineNo: ' + lineNo); // 异常行号
                        console.log('columnNo: ' + columnNo); // 异常列号
                        console.log('error: ' + error); // 异常堆栈信息
                    };

                    console.log(a);
            资源加载错误：
                1.object.onerror
                2.performance.getEntries()
                3.Error事件捕获 
        延伸问题：跨域js运行错误可以捕获吗？错误提示是什么？应该怎么处理呢？
    　　    跨域js运行错误也是可以捕获到的，但是拿不到具体的信息，比如：出错行号、出错列号，错误详情等，这种问题应该怎么处理呢？
        　　1.在script标签上增加crossorigin="anonymous"属性；
        　　2.设置js资源响应头Access-Control-Allow-Origin:*（服务器端设置）； 意思是所有域都可以访问

        3.上报错误的基本原理
            1.采用Ajax通信的方式上报
            2.利用Image对象上报（常用）
    -->
    <!-- 利用Image对象上报错误：动态创建Image对象 -->
    <script>
        // (new Image()).src = "http://baidu.com/test?re=123"

        // window.onerror = function(errorMessage, scriptURI, lineNo, columnNo, error) {
        //     console.log('errorMessage: ' + errorMessage); // 异常信息
        //     console.log('scriptURI: ' + scriptURI); // 异常文件路径
        //     console.log('lineNo: ' + lineNo); // 异常行号
        //     console.log('columnNo: ' + columnNo); // 异常列号
        //     console.log('error: ' + error); // 异常堆栈信息
        // };

        // console.log(a);
    </script>
    <script src="//baidu.com/test.js"></script>
</body>
</html>